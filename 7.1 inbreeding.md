# calculate inbreeding coefficient with --het output from vcftools in R

```{r}
# Mainland vs Island:
het_data <- read.table("~/Desktop/Mohua_Analyses/inbreeding_diveristy_relatedness/all_het.txt", h=TRUE)

island_het <- subset(het_data, Location == "Island")
mainland_het <- subset(het_data, Location == "Mainland")

#####Plot per population:
boxplot(het_data$F ~ het_data$Population, col = "white", ylab="inbreeding coefficient", xlab = NULL, frame=F, lwd=1.5, par(cex.lab=1.5), par(cex.axis=1.5)) 


#####plot Mainland vs Island:
#bring in right order (Mainland first):
het_data$Location <- factor(het_data$Location , levels=c("Mainland", "Island"))

boxplot(het_data$F ~ het_data$Location, col = "white", ylab=expression('F'[H]), xlab = NULL, border= c("#71BA31", "#2F26BA"),frame=F, lwd=1.5, par(cex.lab=1.8), par(cex.axis=1.8), ylim = c(-0.1, 0.3))


##### BlueMt - Island complex:

het_data <- read.table("~/Desktop/Mohua_Analyses/inbreeding_diveristy_relatedness/bluemt-isl.het.txt", h=TRUE)

#bring in right order:
het_data$Population <- factor(het_data$Population , levels=c("BlueMt", "Breaksea", "Anchor", "WhenuaHou", "Chalky"))
boxplot(het_data$F ~ het_data$Population, col="white", border= c("#71BA31", "#4FADEA", "#2F26BA", "#2F26BA", "#2F26BA"), ylab=expression('F'[H]), xlab = NULL, names = c("Blue Mountains", "Breaksea Is", "Anchor Is", "Whenua Hou", "Chalky Is" ), frame=F, lwd=1.5, par(cex.lab=1.8), par(cex.axis=1.8), ylim = c(-0.1, 0.20))


#To test for significance between Mainland and Island:

het_data <- read.table("~/Desktop/Mohua_Analyses/inbreeding_diveristy/all_het.txt", h=TRUE)

island_het <- subset(het_data, Location == "Island")
mainland_het <- subset(het_data, Location == "Mainland")

plot(density(island_het$F))
plot(density(mainland_het$F))


mean(mainland_het$F) - mean(island_het$F)

#bootstrap loop:

sample_diff <- c()
for (i in 1:1000000) {
  random_group_1 <- sample(het_data$F, 54, replace=T)
  random_group_2 <- sample(het_data$F, 199, replace=T)
  sample_diff[i] <- mean(random_group_2) - mean(random_group_1)
}

quantile(sample_diff,c(0.025,0.975))


#visualize

hist(sample_diff,
     xlab = "Difference between Mainland and Island",
     main = "Randomisation distribution of 1000000 bootstraps"
     ,col="grey")

abline(v=quantile(sample_diff,c(0.025,0.975)),col="black",lwd=2)
abline(v=-0.01755549, col="blue")  #insert mean value(s) here

#p-value:

sum(abs(sample_diff)>=0.01755549)/1000000 # insert real difference of means
```



